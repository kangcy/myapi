function InitReady(){var e=base.Get("download-bar").clientHeight;$wrapper.style.paddingTop=$wrapper2.style.top=$wrapper21.style.top=e+"px",base.Get("music1").style.top=e+20+"px",window.innerWidth>750&&(base.Get("music1").style.right=(window.innerWidth-750)/2+18+"px"),mui("#wrapper").on("tap",".user",function(e){window.location.href=GetRootUrl()+"/u/"+this.getAttribute("userid")}),window.addEventListener("scroll",function(e){if(CurrTemplateJson&&2==CurrTemplateJson.CoverFixed){var r=document.documentElement.scrollTop||document.body.scrollTop;r>=150?($wrapper2.style.opacity=0,$wrapper21.style.opacity=1):($wrapper2.style.opacity=1-r/150,$wrapper21.style.opacity=r/150)}})}function ChangeMusic(e){$("#music0,#music1").addClass("hide"),MusicID="music"+(0==CurrTemplate?0:1),base.IsNullOrEmpty(MusicUrl)||(1==Article.AutoMusic&&(document.addEventListener("touchstart",startsound),document.addEventListener("click",startsound)),base.Get("music"+(0==CurrTemplate?0:1)).classList.remove("hide"))}function ChangeThemeColor(e){null!=e&&(base.Get("title0").style.color=e.TitleColor,base.Get("nickname0").style.color=e.UserColor,base.Get("nickname1").style.color=e.UserColor,base.Get("createdate0").style.color=e.TimeColor,base.Get("views0").style.color=e.ViewColor,$avatar.style.border="2px solid "+e.TitleColor)}function ChangeBg(){switch(0==CurrTemplate?(base.Get("title0").classList.remove("well2"),base.Get("x-avatar").classList.add("hide"),base.Get("x-article").classList.remove("tc"),base.Get("x-article").classList.add("tl"),base.Get("nickname1").classList.add("hide"),base.Get("nickname0").classList.remove("hide"),base.Get("x-content").classList.remove("mt10"),$head.style.marginTop="1rem"):(base.Get("title0").classList.add("well2"),base.Get("x-avatar").classList.remove("hide"),base.Get("x-article").classList.remove("tl"),base.Get("x-article").classList.add("tc"),base.Get("nickname0").classList.add("hide"),base.Get("nickname1").classList.remove("hide"),base.Get("x-content").classList.add("mt10"),$head.style.marginTop="3rem"),mui.each(mui(".edit-content"),function(e,r){r.classList.remove("well2")}),CurrTemplateJson.PaddingFixed){case 0:$body.classList.add("well2"),$edit.classList.add("temp");break;case 1:$edit.classList.remove("temp"),$body.classList.add("well2");break;case 2:$body.classList.remove("well2"),$edit.classList.add("temp");break;case 3:$body.classList.remove("well2"),$edit.classList.remove("temp"),mui.each(mui(".edit-content"),function(e,r){r.classList.add("well2")});break;default:$body.classList.add("well2"),$edit.classList.add("temp")}if(ChangeMusic(),$top.classList.add("hide"),$bottom.classList.add("hide"),$body.style.margin="0",$wrapper.style.color="#333",$wrapper.style.backgroundColor="",$wrapper1.classList.remove("x-cover"),$wrapper1.style.background="",$cover.style.backgroundColor="",$cover1.style.backgroundColor="",$wrapper2.classList.add("hide"),$wrapper21.classList.add("hide"),$wrapper2.style.background="",$wrapper2.style.opacity="1",$wrapper21.style.background="",$wrapper21.style.opacity="0",$avatarbg.style.backgroundImage="",$avatarbg.style.width="5rem",$avatarbg.style.height="5rem",$avatar.style.width="100%",$avatar.style.left="0",$avatar.style.top="0",$avatar.style.borderRadius="50%",$avatar.style.zIndex="-1",$avatarbg.style.marginBottom="1rem",CurrTemplateJson.ShowAvatar<0&&base.Get("x-avatar").classList.add("hide"),base.IsNullOrEmpty(CurrTemplateJson.FontColor)||($wrapper.style.color=CurrTemplateJson.FontColor),CurrTemplate>1){if(!base.IsNullOrEmpty(CurrTemplateJson.TopImage)){for(var e=[],r=0;r<CurrTemplateJson.TopImage.length;r++){var a=CurrTemplateJson.TopImage[r];e.push('<img src="'+a.Url+'" class="'+a.Align+'" style="width:'+a.Width+'" />')}$top.innerHTML=e.join(""),$top.classList.remove("hide")}if(base.IsNullOrEmpty(CurrTemplateJson.BottomImage)||($bottom.setAttribute("src",CurrTemplateJson.BottomImage),$bottom.classList.remove("hide")),null!=CurrTemplateJson.Avatar&&(base.IsNullOrEmpty(CurrTemplateJson.Avatar.BackgroundImage)||($avatarbg.style.backgroundImage="url("+CurrTemplateJson.Avatar.BackgroundImage+")"),base.IsNullOrEmpty(CurrTemplateJson.Avatar.Width)||($avatarbg.style.width=CurrTemplateJson.Avatar.Width),base.IsNullOrEmpty(CurrTemplateJson.Avatar.Height)||($avatarbg.style.height=CurrTemplateJson.Avatar.Height),base.IsNullOrEmpty(CurrTemplateJson.Avatar.MarginBottom)||($avatarbg.style.marginBottom=CurrTemplateJson.Avatar.MarginBottom),base.IsNullOrEmpty(CurrTemplateJson.Avatar.MarginTop)||(0==CurrTemplateJson.TransparencyFixed?$head.style.marginTop=CurrTemplateJson.Avatar.MarginTop:($body.style.marginTop=CurrTemplateJson.Avatar.MarginTop,$head.style.marginTop="1rem")),base.IsNullOrEmpty(CurrTemplateJson.Avatar.SubWidth)||($avatar.style.width=CurrTemplateJson.Avatar.SubWidth),base.IsNullOrEmpty(CurrTemplateJson.Avatar.Top)||($avatar.style.top=CurrTemplateJson.Avatar.Top),base.IsNullOrEmpty(CurrTemplateJson.Avatar.Left)||($avatar.style.left=CurrTemplateJson.Avatar.Left),base.IsNullOrEmpty(CurrTemplateJson.Avatar.BorderRadius)||($avatar.style.borderRadius=CurrTemplateJson.Avatar.BorderRadius),base.IsNullOrEmpty(CurrTemplateJson.Avatar.Index)||($avatar.style.zIndex=CurrTemplateJson.Avatar.Index),base.IsNullOrEmpty(CurrTemplateJson.Avatar.Border)||($avatar.style.border=CurrTemplateJson.Avatar.Border)),0==CurrTemplateJson.TransparencyFixed?$cover.style.backgroundColor=CurrTemplateJson.Transparency:$cover1.style.backgroundColor=CurrTemplateJson.Transparency,0==CurrTemplateJson.CoverFixed){if($wrapper1.classList.add("x-cover"),!base.IsNullOrEmpty(CurrTemplateJson.BackgroundImage)){for(var t=[],s=CurrTemplateJson.BackgroundImage.split("?"),r=0;r<s.length;r++)t.push("url("+s[r]+")");$wrapper1.style.backgroundImage=t.join(","),base.IsNullOrEmpty(CurrTemplateJson.BackgroundPosition)||($wrapper1.style.backgroundPosition=CurrTemplateJson.BackgroundPosition),base.IsNullOrEmpty(CurrTemplateJson.BackgroundRepeat)||($wrapper1.style.backgroundRepeat=CurrTemplateJson.BackgroundRepeat),base.IsNullOrEmpty(CurrTemplateJson.BackgroundSize)||($wrapper1.style.backgroundSize=CurrTemplateJson.BackgroundSize)}base.IsNullOrEmpty(CurrTemplateJson.Background)||($wrapper.style.background=CurrTemplateJson.Background,CurrTemplateJson.Background.startWith("#")||CurrTemplateJson.Background.startWith("rgba")||($wrapper.style.background=base.BrowserName()+CurrTemplateJson.Background))}else{if(!base.IsNullOrEmpty(CurrTemplateJson.BackgroundImage)){for(var t=[],s=CurrTemplateJson.BackgroundImage.split("?"),r=0;r<s.length;r++)t.push("url("+s[r]+")");$wrapper2.style.backgroundImage=t.join(","),base.IsNullOrEmpty(CurrTemplateJson.BackgroundPosition)||($wrapper2.style.backgroundPosition=CurrTemplateJson.BackgroundPosition),base.IsNullOrEmpty(CurrTemplateJson.BackgroundRepeat)||($wrapper2.style.backgroundRepeat=CurrTemplateJson.BackgroundRepeat),base.IsNullOrEmpty(CurrTemplateJson.BackgroundSize)||($wrapper2.style.backgroundSize=CurrTemplateJson.BackgroundSize),$wrapper2.classList.remove("hide")}if(2==CurrTemplateJson.CoverFixed&&!base.IsNullOrEmpty(CurrTemplateJson.BackgroundBlurImage)){for(var t=[],s=CurrTemplateJson.BackgroundBlurImage.split("?"),r=0;r<s.length;r++)t.push("url("+s[r]+")");$wrapper21.style.backgroundImage=t.join(","),base.IsNullOrEmpty(CurrTemplateJson.BackgroundPosition)||($wrapper21.style.backgroundPosition=CurrTemplateJson.BackgroundPosition),base.IsNullOrEmpty(CurrTemplateJson.BackgroundRepeat)||($wrapper21.style.backgroundRepeat=CurrTemplateJson.BackgroundRepeat),base.IsNullOrEmpty(CurrTemplateJson.BackgroundSize)||($wrapper21.style.backgroundSize=CurrTemplateJson.BackgroundSize),$wrapper21.classList.remove("hide")}base.IsNullOrEmpty(CurrTemplateJson.Background)||(CurrTemplateJson.Background.startWith("#")||CurrTemplateJson.Background.startWith("rgba")?$wrapper2.style.backgroundColor=CurrTemplateJson.Background:($wrapper2.style.background=CurrTemplateJson.Background,$wrapper2.style.background=base.BrowserName()+CurrTemplateJson.Background),$wrapper2.classList.remove("hide"))}}else if(1==CurrTemplate)if(null==CurrBackground)$wrapper2.style.background="",$wrapper2.className="";else{$cover.style.backgroundColor="RGBA(255, 255, 255, "+(100-CurrBackground.Transparency)/100+")";var l=CurrBackground.Url;switch(l=0==CurrBackground.High?base.ShowThumb(l,1):base.ShowThumb(l,0),$wrapper2.className="",CurrBackground.Full){case 0:$wrapper2.style.background="url("+l+") no-repeat top center",$wrapper2.style.backgroundSize="100% 15.5rem";break;case 1:$wrapper2.style.background="url("+l+") center center no-repeat",$wrapper2.style.backgroundSize="cover"}$body.classList.add("well2"),$edit.classList.add("temp")}}function AppendStr(e){var r=document.createElement("div");r.className="mui-table-view-cell";var a=[];return a.push('<div class="mui-slider-cell mt10 mb10"><div class="oa-contact-cell mui-table">'),a.push('<div class="mui-table-cell oa-contact-avatar"><img src="'+base.ShowThumb(e.Avatar,1)+'" class="user" userid="'+e.UserNumber+'" /></div>'),a.push('<div class="mui-table-cell pb0" style="border-bottom:1px solid '+BackgroundColor+'">'),a.push('<p class="f12 user" style="color:'+UserColor+'" userid="'+e.UserNumber+'">'+UnUnicodeText(e.NickName)+'<span class="fr f11" style="color:'+SubTitleColor+'">'+e.CreateDateText+"</span></p>"),a.push('<p class="f11 mt5 mb5 summary" style="line-height:1.3rem;color:'+SubTitleColor+'">'+UnUnicodeText(e.Summary)+"</p>"),base.IsNullOrEmpty(e.ParentCommentNumber)||a.push('<p class="tip mb0 f11" style="line-height:1.3rem;"><span class="user blue summary" userid="'+e.ParentUserNumber+'">@'+UnUnicodeText(e.ParentNickName)+"ï¼š</span>"+UnUnicodeText(e.ParentSummary)+"</p>"),a.push("</div></div>"),r.innerHTML=a.join(""),r}function InitArticle(e){mui.each(mui(".user"),function(r,a){a.setAttribute("userid",e.CreateUserNumber),a.setAttribute("nickname",e.NickName),a.setAttribute("avatar",e.Avatar),a.setAttribute("cover",e.Cover)});var r=[],a=e.ArticlePart;if(null!=a)for(var t=0;t<a.length;t++){var s=a[t];if(1==s.Types)r.push('<div class="full f13 fl mt10 '+s.IntroExpand+'"><img onload="LazyImg(this)" src="img/default.png" data-lazyload="'+base.ShowThumb(s.Introduction,1)+'" class="full fl" /></div>');else if(2==s.Types){var l=document.createElement("div");l.innerHTML=UnUnicodeText(s.Introduction),$(l).find(".edit").addClass(s.IntroExpand),r.push('<div class="full f13 fl mt10 edit-content">'+l.innerHTML+"</div>")}else 3==s.Types?r.push('<div class="full f13 fl mt10 hide" style="display:inline-block;">'+AppendVideo(s.Introduction)+"</div>"):4==s.Types&&r.push('<div class="full f13 fl mt10" style="display:inline-block;">'+s.Introduction+"</div>")}MusicUrl=e.MusicUrl,CurrBackground=e.BackgroundJson,CurrTemplate=e.Template,null!=e.TemplateJson&&1!=e.TemplateJson.ID&&(CurrTemplateJson=e.TemplateJson,null==e.ColorTemplateJson&&(TitleColor=CurrTemplateJson.TitleColor,SubTitleColor=CurrTemplateJson.ViewColor,UserColor=CurrTemplateJson.UserColor,BackgroundColor=CurrTemplateJson.Transparency,ChangeThemeColor(CurrTemplateJson))),null!=e.ColorTemplateJson&&(TitleColor=e.ColorTemplateJson.TitleColor,SubTitleColor=e.ColorTemplateJson.ViewColor,UserColor=e.ColorTemplateJson.UserColor,ChangeThemeColor(e.ColorTemplateJson)),base.Get("musicname0").innerHTML=e.MusicName,base.Get("useravatar0").setAttribute("src",base.ShowThumb(e.Avatar,1)),base.InnerHtml(["title","title0"],e.Title),base.InnerHtml(["nickname","nickname0","nickname1"],e.NickName),base.InnerHtml(["createdate0"],e.CreateDateText),base.InnerHtml(["views0"],"é˜…è¯»  "+e.Views),base.Get("x-head").classList.remove("hide"),base.Get("desc").innerHTML=UnUnicodeText(r.join("")),ChangeBg(),$(".youku_player").each(function(){var e=$(this);ShowVideo(e.attr("id"),e.attr("sid"))}),mui.each(document.querySelectorAll(".video"),function(){var e=this;e.addEventListener("canplay",function(){e.parentNode.classList.remove("hide")})}),document.getElementById("loader").classList.add("hide"),$("#wrapper").removeClass("hide"),base.Get("color-lump").style.background=TitleColor,base.Get("color-lump-text").style.color=TitleColor,LoadComment(key),base.IsNullOrEmpty(e.Showy)||LoadScript("min/snow.min.js",function(){var r=e.Showy.split("|");r.length>2?snow.init(r[0],r[1],r[2]):snow.init(e.Showy,1,0)}),mui("#desc").on("tap","a.link",function(){var e=this.getAttribute("link");base.IsNullOrEmpty(e)||(window.location.href=e)}),isLoading=!1}function LoadComment(e){$.ajax({type:"GET",url:RootUrl,data:{number:e,action:"comment"},dataType:"json",success:function(e){if(null!=e&&(e=JSON.parse(e)).result){if((e=e.message).records>0){document.getElementById("commentlist").classList.remove("hide");for(var r=document.getElementById("commentlist"),a=0,t=e.list.length;a<t;a++){var s=AppendStr(e.list[a]);r.appendChild(s)}$("#comment").removeClass("hide")}}}})}var RootUrl="http://localhost:3000/api",MusicID=0,MusicUrl="",ArticleID=0,CurrTemplate=0,CurrCover="",CurrColor="",Article=null,CurrBackground=null,CurrTemplateJson=null,TitleColor="#2887F0",UserColor="#333",SubTitleColor="#8c8c8c",BackgroundColor="rgba(255, 255, 255, 0.15)",isLoading=!1,$header=base.Get("header"),$wrapper=base.Get("wrapper"),$wrapper1=base.Get("x-cover"),$wrapper2=base.Get("x-bg"),$wrapper21=base.Get("x-bg-base"),$cover=base.Get("x-bg-blur"),$cover1=base.Get("x-bg-blur1"),$head=base.Get("x-head"),$body=base.Get("x-body"),$top=base.Get("x-top"),$bottom=base.Get("x-bottom"),$avatarbg=base.Get("x-avatar-sub"),$avatar=base.Get("useravatar0"),$edit=base.Get("desc");